!function(){"use strict";function a(a,b){var c=a.toFixed(b);return c}function b(a){var b=a.replace("R$ ","").replace(",",".");return parseFloat(b)}var c=angular.module("App",["ngRoute","ngCookies"]);c.config(["$routeProvider",function(a){a.when("/",{templateUrl:"../src/templates/views/home.html"}).when("/sacola",{templateUrl:"../src/templates/views/sacola.html"}).when("/produtos/promocoes",{templateUrl:"../src/templates/views/produtos-promocoes.html"}).when("/produto/codigo/:code",{templateUrl:"../src/templates/views/produto-interna.html"}).otherwise({templateUrl:"../src/templates/views/404.html",controller:"Page404Ctrl"})}]),c.filter("filterColor",[function(){return function(a,b){var c=[];return b.length>0?(angular.forEach(b,function(b){angular.forEach(a,function(a){a.color_slug==b.cor&&c.push(a)})}),c):a}}]),c.run(["$rootScope","$cookies",function(a,b){a.$on("$routeChangeStart",function(){a.title="Conectando...",a.classMenuMob="",a.loaded=!0,a.hasItemCar=!1,a.totalItemCar=0;var c=b.getObject("items_data");if(c.length>0){var d=0;a.hasItemCar=!0,angular.forEach(c,function(a,b){d+=parseInt(a.qtd)}),a.totalItemCar=d}}),a.classMenuMob="",a.menuMob=function(){""==a.classMenuMob?a.classMenuMob=" active":a.classMenuMob=""}}]),c.controller("HomeCtrl",["$scope","apiConnect","$location","$routeParams","$rootScope",function(a,b,c,d,e){a.products=b.getProducts().then(function(b){e.loaded=!1,e.title="Roupas Femeninas, Vestidos, blusa, Sapatos - AMARO",a.allProducts=b.data.products,a.selectColor=!1,a.selectorClass=!1,a.objectColors=[],a.addColor=function(){0==a.selectorClass?(a.selectorClass=!0,a.selectColor=!0,a.getcolor=function(b,c){a.selectorClass=!1,a.selectColor=!1;var d={cor:b,text:c},e=!0;angular.forEach(a.objectColors,function(a,c){a.cor==b&&(e=!1)}),e&&(a.objectColors.push(d),a.removeColor=function(b){angular.forEach(a.objectColors,function(c,d){c.cor==b&&a.objectColors.splice(d,1)})})}):(a.selectorClass=!1,a.selectColor=!1)}},function(a){console.error(a)})}]),c.controller("ProductsCtrl",["$scope","apiConnect","$location","$routeParams","$rootScope","$cookies",function(a,b,c,d,e,f){var g=d.code;a.products=b.getProductsSlug(g).then(function(b){e.loaded=!1,e.title=b[0].name+" - AMARO",a.getProduct=b,a.tam=null,a.validate=!1,a.size=function(b){a.tam=b,a.validate=!1},a.addToCar=function(b,d){if(null==d)return a.validate=!0,!1;var e=f.getObject("items_data"),g=[],h=1;e?(angular.forEach(e,function(a,c){a.item!=b||a.size!=d?g.push(a):h=a.qtd+1}),g.push({item:b,size:d,qtd:h})):g=[{item:b,size:d,qtd:h}],f.putObject("items_data",g),c.path("/sacola")}},function(a){console.error(a)})}]),c.controller("SacolaCtrl",["$scope","apiConnect","$location","$routeParams","$rootScope","$cookies",function(c,d,e,f,g,h){g.loaded=!1,g.title="Sacola - AMARO";var i=h.getObject("items_data"),j=[];angular.forEach(i,function(a,b){j.push({item:a.item,size:a.size,qtd:a.qtd})}),c.getDataJson=function(){c.items=d.getProductsCar(j).then(function(d){c.carItems=d,g.totalItemCar=0;var e=0,f=0;angular.forEach(d,function(a){e+=parseInt(a.qtd)*b(a.price),f+=parseInt(a.qtd)}),0==d.length&&(g.hasItemCar=!1),g.totalItemCar=f,c.priceTotal=a(e,2)},function(a){console.error(a)})},c.removeItem=function(a,b){var d=h.getAll();return angular.forEach(d,function(a,b){h.remove(b)}),angular.forEach(j,function(c,d){c.item==a&&c.size==b&&j.splice(d,1)}),h.putObject("items_data",j),c.getDataJson(),!1},c.updateQtd=function(a,b,d,e){var f=h.getAll();return angular.forEach(f,function(a,b){h.remove(b)}),"remove"==e&&1==d&&angular.forEach(j,function(c,d){c.item==a&&c.size==b&&j.splice(d,1)}),angular.forEach(j,function(c,f){if(c.item==a&&c.size==b){var g="add"==e?d+1:d-1;j[f]={item:c.item,size:c.size,qtd:g}}}),h.putObject("items_data",j),c.getDataJson(),!1},c.getDataJson()}]),c.controller("ProductsSaleCtrl",["$scope","apiConnect","$location","$routeParams","$rootScope",function(a,b,c,d,e){a.products=b.getProductsSales().then(function(b){e.loaded=!1,e.title="Produtos em Promoção - AMARO",a.allProducts=b},function(a){console.error(a)})}]),c.controller("Page404Ctrl",["$scope","$rootScope",function(a,b){b.loaded=!1,b.title="Ops. Página  não encontrada - AMARO"}]),c.factory("apiConnect",["$q","$http",function(a,b){return{getProducts:function(){var c=a.defer(),d=b.get("products.json");return d.then(function(a){c.resolve(a)},function(a){console.error(a)}),c.promise},getProductsSlug:function(c){var d=a.defer(),e=b.get("products.json");return e.then(function(a){var b=[];angular.forEach(a.data.products,function(a,d){a.code_color==c&&b.push(a)}),d.resolve(b)},function(a){console.error(a)}),d.promise},getProductsCar:function(c){var d=a.defer(),e=b.get("products.json");return e.then(function(a){var b=[];angular.forEach(c,function(c){angular.forEach(a.data.products,function(a,d){a.code_color==c.item&&b.push({qtd:c.qtd,name:a.name,item:a.code_color,price:a.actual_price,size:c.size,color:a.color,color_slug:a.color_slug,image:a.image})})}),d.resolve(b.reverse())},function(a){console.error(a)}),d.promise},getProductsSales:function(){var c=a.defer(),d=b.get("products.json");return d.then(function(a){var b=[];angular.forEach(a.data.products,function(a,c){1==a.on_sale&&b.push(a)}),c.resolve(b)},function(a){console.error(a)}),c.promise}}}])}();